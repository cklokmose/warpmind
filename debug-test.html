<!DOCTYPE html>
<html>
<head>
    <title>Debug Warpmind</title>
</head>
<body>
    <div id="output"></div>
    <button onclick="testBasicFunctionality()">Test Basic</button>
    <button onclick="testStreaming()">Test Streaming</button>
    <button onclick="testToolRegistration()">Test Tools</button>
    
    <script src="dist/warpmind.js"></script>
    <script>
        function log(message) {
            const output = document.getElementById('output');
            output.innerHTML += message + '<br>';
        }
        
        const wm = new Warpmind({
            baseURL: 'http://localhost:8080/v1',
            apiKey: 'test-key'
        });
        
        async function testBasicFunctionality() {
            try {
                log('Testing basic chat...');
                const response = await wm.chat('Hello');
                log('Chat response: ' + response);
            } catch (error) {
                log('Error: ' + error.message);
            }
        }
        
        async function testStreaming() {
            try {
                log('Testing streaming...');
                let streamedText = '';
                await wm.streamChat('Tell me a joke', (chunk) => {
                    log('Received chunk: ' + JSON.stringify(chunk));
                    if (typeof chunk === 'string') {
                        streamedText += chunk;
                    } else if (chunk && chunk.content) {
                        streamedText += chunk.content;
                    }
                });
                log('Final streamed text: ' + streamedText);
            } catch (error) {
                log('Streaming error: ' + error.message);
            }
        }
        
        function testToolRegistration() {
            try {
                log('Testing tool registration...');
                wm.registerTool({
                    name: 'testTool',
                    description: 'A test tool',
                    parameters: {
                        type: 'object',
                        properties: {
                            input: { type: 'string' }
                        },
                        required: ['input']
                    },
                    handler: async (args) => {
                        return { message: 'Tool executed with: ' + args.input };
                    }
                });
                log('Tool registered successfully');
                log('Tools list: ' + JSON.stringify(wm._tools.map(t => t.schema.function.name)));
            } catch (error) {
                log('Tool registration error: ' + error.message);
            }
        }
    </script>
</body>
</html>
